(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/lottery/detail"],{"2eaa":function(t,i,e){"use strict";e.r(i);var n=e("a4da"),o=e("b7dc");for(var u in o)"default"!==u&&function(t){e.d(i,t,(function(){return o[t]}))}(u);e("b579");var r,s=e("f0c5"),a=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,"07a40b7e",null,!1,n["a"],r);i["default"]=a.exports},3021:function(t,i,e){"use strict";(function(t){e("e335");n(e("66fd"));var i=n(e("2eaa"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=e,t(i.default)}).call(this,e("543d")["createPage"])},5283:function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=e("26cb");function o(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),e.push.apply(e,n)}return e}function u(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{};i%2?o(Object(e),!0).forEach((function(i){r(t,i,e[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}))}return t}function r(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var s=function(){Promise.all([e.e("common/vendor"),e.e("pages/lottery/components/PayCard")]).then(function(){return resolve(e("45b7"))}.bind(null,e)).catch(e.oe)},a=function(){e.e("pages/lottery/components/MyTicket").then(function(){return resolve(e("8809"))}.bind(null,e)).catch(e.oe)},c=function(){e.e("pages/lottery/components/InvitePopup").then(function(){return resolve(e("5286"))}.bind(null,e)).catch(e.oe)},l={components:{PayCard:s,MyTicket:a,InvitePopup:c},data:function(){return{isShowPayCard:!1,title:"活动详情",uuid:"",isShowTitle:!1,activityId:"",info:{},isShowMyTicket:!1,luckyUserList:[],userList:[],inviterUuid:"",inviteInfo:{},isNotFound:!1,isInit:!1,isShowInvitePopupKey:!1}},computed:u(u({},(0,n.mapGetters)(["userInfo"])),{},{isShowInvitePopup:function(){return this.inviterUuid&&this.userInfo.uuid!==this.inviterUuid&&this.isShowInvitePopupKey},progressPercentStr:function(){return"user_total"===this.info.emit_type?this.info.emit_user_total?this.info.current_session_records_count/this.info.emit_user_total*100+"%":"0%":"ticket_total"===this.info.emit_type?this.info.emit_ticket_total?this.info.current_session_lottery_tickets_count/this.info.emit_ticket_total*100+"%":"0%":""},share:function(){var t=this.info.title;return this.userInfo.name&&(t=this.userInfo.name+"邀请您来助力赢奖品哦~"),{title:t,thumb:this.info.thumb}}}),watch:{},onLoad:function(i){var e=this;this.uuid=i.uuid,this.activityId=i.activityId,this.inviterUuid=i.inviter||"",this.inviterUuid&&this.initInviteInfo(),t.showLoading({title:"加载中"}),this.initData().then((function(i){e.isInit=!0,t.hideLoading(),e.$visitor.record({type:"activity_detail",title:e.info.title,uuid:e.info.uuid})})).catch((function(t){404==t.statusCode&&(e.isNotFound=!0)}))},onShow:function(){var t=this;this.isInit&&this.initData().then((function(i){t.isInit=!0})).catch((function(i){404==i.statusCode&&(t.isNotFound=!0)}))},methods:{initInviteInfo:function(){var t=this;return this.$http("/lotteries/".concat(this.uuid,"/invite-info"),"GET",{inviter:this.inviterUuid}).then((function(i){t.inviteInfo=i.data,i.data.record_id&&(t.isShowInvitePopupKey=!0)}))},initData:function(){var t=this;return this.$http("/lotteries/".concat(this.uuid)).then((function(i){t.info=i.data.info,console.log(t.info),t.initUserList("all"),"expired"===t.info.union_status&&t.initUserList("lucky")}))},initUserList:function(t){var i=this;return this.$http("/lotteries/".concat(this.uuid,"/users"),"GET",{type:t,session:"current",per_page:5}).then((function(e){"lucky"===t?i.luckyUserList=e.data.list:i.userList=e.data.list}))},pendingTips:function(){t.showToast({title:"活动还没有开始哦~",icon:"none"})},handleJoin:function(){if(!this.userInfo.uuid)return t.navigateTo({url:"/pages/login/index"}),!1;this.isShowPayCard=!0},joinSuccess:function(){this.isShowPayCard=!1,this.initData(),t.navigateTo({url:"/pages/lotteryTicket/index?uuid="+this.info.uuid}),t.showToast({title:"参与成功",icon:"none"}),this.$store.dispatch("getUserInfo")},getMyPrize:function(){t.showModal({title:"恭喜您中奖啦，快点左下角联系客户领取奖品吧~"})},topage:function(){t.reLaunch({url:"/pages/index/index"})}},onPageScroll:function(i){i.scrollTop>350&&!this.isShowTitle&&(t.setNavigationBarTitle({title:this.info.title}),this.isShowTitle=!0),i.scrollTop<350&&this.isShowTitle&&(t.setNavigationBarTitle({title:"活动详情"}),this.isShowTitle=!1)}};i.default=l}).call(this,e("543d")["default"])},"53ff":function(t,i,e){},a4da:function(t,i,e){"use strict";e.d(i,"b",(function(){return o})),e.d(i,"c",(function(){return u})),e.d(i,"a",(function(){return n}));var n={CountDown:function(){return e.e("components/CountDown/CountDown").then(e.bind(null,"815b"))},NoData:function(){return e.e("components/NoData/NoData").then(e.bind(null,"7ef1"))}},o=function(){var t=this,i=t.$createElement,e=(t._self._c,t.isInit?t.__map(t.userList,(function(i,e){var n=t.__get_orig(i),o=i.user?i.user.name.slice(0,1):null;return{$orig:n,g0:o}})):null),n=t.isInit&&"expired"==t.info.union_status?t.__map(t.luckyUserList,(function(i,e){var n=t.__get_orig(i),o=i.user?i.user.name.slice(0,1):null;return{$orig:n,g1:o}})):null,o=t.isInit&&"expired"!=t.info.union_status&&"time"===t.info.emit_type?t.$tool.formatDate(t.info.emit_time,"MM/dd hh:mm"):null;t._isMounted||(t.e0=function(i){return t.$tool.toPage("/pages/lotteryActivity/userList?uuid="+t.info.uuid+"&type=all")},t.e1=function(i){return t.$tool.previewImage([t.info.thumb],0)},t.e2=function(i){return t.$tool.copyText(t.contactAccount)},t.e3=function(i){return t.$tool.toPage("/pages/lottery/userList?uuid="+t.info.uuid+"&type=all&actived=1")},t.e4=function(i){return t.$tool.toPage("/pages/lottery/userList?uuid="+t.info.uuid+"&type=lucky")},t.e5=function(i,e){var n=arguments[arguments.length-1].currentTarget.dataset,o=n.eventParams||n["event-params"];e=o.index;return t.$tool.previewImage(t.info.images,e)},t.e6=function(i){t.isShowMyTicket=!0},t.e7=function(i){t.isShowMyTicket=!0},t.e8=function(i){t.isShowMyTicket=!0},t.e9=function(i){t.isShowMyTicket=!0},t.e10=function(i){t.isShowPayCard=!1},t.e11=function(i){t.isShowMyTicket=!1},t.e12=function(i){t.isShowInvitePopupKey=!1}),t.$mp.data=Object.assign({},{$root:{l0:e,l1:n,g2:o}})},u=[]},b579:function(t,i,e){"use strict";var n=e("53ff"),o=e.n(n);o.a},b7dc:function(t,i,e){"use strict";e.r(i);var n=e("5283"),o=e.n(n);for(var u in n)"default"!==u&&function(t){e.d(i,t,(function(){return n[t]}))}(u);i["default"]=o.a}},[["3021","common/runtime","common/vendor"]]]);