(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/productDetail/index"],{"0287":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i("26cb");function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){u(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var s=function(){i.e("pages/productDetail/components/SwiperImages").then(function(){return resolve(i("56f2"))}.bind(null,i)).catch(i.oe)},c=function(){i.e("pages/productDetail/components/ProductDetail").then(function(){return resolve(i("96a0"))}.bind(null,i)).catch(i.oe)},a=function(){i.e("components/InputNumber/index").then(function(){return resolve(i("2872"))}.bind(null,i)).catch(i.oe)},l=function(){i.e("components/SplitLine/index").then(function(){return resolve(i("3884"))}.bind(null,i)).catch(i.oe)},d={components:{SwiperImages:s,ProductDetail:c,IInputNumber:a,SplitLine:l},data:function(){return{grouponRecordId:null,loading:!0,actionType:"buynow",uuid:"",product:{},mode:"",skusVisible:!1,currentSkuAttrs:{},buyCount:1,scrollTop:0,grouponStatus:0,isShowTitle:!1,chipAssetList:[],isSharePopup:!1,currentGroupPriceUuid:"",useGroupPrice:null,isShowUserGroupCheck:!1,isShowOrderReward:!1,seckillId:"",isShowSeckillPriceCheck:!1}},computed:o(o({},(0,n.mapGetters)(["token"])),{},{isShowReward:function(){var t=this.product.order_reward||{};return t.is_score||t.is_level_score||t.is_redpack||t.is_show_box_card||t.is_exclude_box_card},skus:function(){return this.product.skus||[]},images:function(){return this.product.ext&&this.product.ext.images||[this.product.thumb]},skusAttrs:function(){var t=this.product.ext&&this.product.ext.sku_attrs||[],e={};return t.forEach((function(t,i){e[i]=t.value[0]})),this.currentSkuAttrs=e,t},currentSku:function(){for(var t=this,e=this.skus,i=function(i){var n="",r="";if(e[i].attrs.forEach((function(e,i){n=n+e.value+"_",r=r+t.currentSkuAttrs[i]+"_"})),n===r)return{v:e[i]}},n=0;n<e.length;n++){var r=i(n);if("object"===typeof r)return r.v}return{}},posterInfo:function(){var t=this.getShareConfig(!1);return{money_price:this.product.money_price,score_price:this.product.score_price,title:this.product.title,path:this.getShareConfig().path,thumb:this.product.thumb,app_url:t.app_url}},share:function(){return{title:this.product.title,thumb:this.product.thumb}}}),filters:{priceToFixed:function(t){return t&&(t/100).toFixed(2)},productAttrsToString:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[];return t.forEach((function(t){e.push(t.value)})),e.join("/")}},onLoad:function(t){this.uuid=t.uuid,this.mode=t.mode,this.seckillId=t.seckillId||"",this.initData()},onShow:function(){},methods:{handleExchange:function(){this.handleBuynow()},handleSeckillBuy:function(){this.product.seckill.user_group_id?this.isShowSeckillPriceCheck=!0:this.buyWithSeckill()},buyWithSeckill:function(){this.isShowSeckillPriceCheck=!1,this.skusVisibleChange()},buyWithGroupPrice:function(t){this.isShowUserGroupCheck=!1,this.useGroupPrice=this.product.group_prices.find((function(e){return e.id===t.id})),this.skusVisibleChange()},showGroupPrice:function(t){this.currentGroupPriceUuid=t.uuid,this.isShowUserGroupCheck=!0},showOrderReward:function(){this.isShowOrderReward=!0},presellStart:function(){this.initData()},initData:function(){var t=this;this.getProductInfo().then((function(e){t.$visitor.record({type:"product_detail",title:t.product.title,uuid:t.product.uuid})}))},handleAddSaleNotify:function(){var e=this;t.requestSubscribeMessage({tmplIds:[this.miniappSubscribeIds.presell_start],success:function(t){e.$http("/subscribe","POST",{target_uuid:e.product.uuid,app_type:1,message_type:"presell_start"}).then((function(t){e.product.is_subscribed=1}))},fail:function(t){console.log(t)}})},previewImage:function(e){t.previewImage({urls:[e]})},hideSkuContainer:function(){this.grouponRecordId=null,this.skusVisibleChange()},skusVisibleChange:function(){this.skusVisible=!this.skusVisible,this.skusVisible||(this.useGroupPrice=null)},handleAddcart:function(){this.token?(t.showToast({title:"已加入购物车",icon:"none"}),this.$api.emit("product.cart.store",{sku_id:this.currentSku.id,total:this.buyCount})):t.navigateTo({url:"/pages/login/index"})},handleAction:function(t){this.actionType=t.currentTarget.dataset.type,this.actionType&&this.skusVisibleChange()},buyCountChange:function(t){this.buyCount=t},handleBuynow:function(){if(!this.currentSku.stock||!this.currentSku.status)return t.showToast({title:"库存不足~",icon:"none"}),!1;if(this.token){var e=[{id:this.currentSku.id,total:this.buyCount}],i="/pages/orderPreview/index?skus="+JSON.stringify(e)+"&seckillId="+this.seckillId;this.useGroupPrice&&(i+="&groupPriceUuid="+this.useGroupPrice.uuid),t.navigateTo({url:i})}else t.navigateTo({url:"/pages/login/index"})},handleExchangeSubmit:function(){var e=[{id:this.currentSku.id,total:1}];t.navigateTo({url:"/pages/exchange/orderPreview?skus="+JSON.stringify(e)})},handleChipCover:function(){var e=this;this.$http("/chip-assets").then((function(i){e.chipAssetList=i.data.list;var n=e.chipAssetList.find((function(t){return t.id==e.currentSku.cover_chip_id}));if(!n||n.balance<e.currentSku.cover_chip_total)return t.showModal({title:"碎片资产不足",content:"请先收集足够的碎片再来兑换哦~",confirmText:"查看碎片",success:function(e){e.confirm&&t.navigateTo({url:"/pages/myChip/index"})}}),!1;var r=[{id:e.currentSku.id,total:e.buyCount}];t.navigateTo({url:"/pages/orderPreview/index?skus="+JSON.stringify(r)+"&coverType=chip"})}))},handleBuyByGroupon:function(){if(this.token){var e=[{id:this.currentSku.id,total:this.buyCount}];t.navigateTo({url:"/pages/groupon/orderPreview/index?skus="+JSON.stringify(e)+"&groupon_record_id="+(this.grouponRecordId||"")})}else t.navigateTo({url:"/pages/login/index"})},currentSkuAttrsChange:function(t){var e=t.currentTarget.dataset.index,i=t.currentTarget.dataset.value;this.currentSkuAttrs[e]=i},getProductInfo:function(){var e=this;t.showLoading({});var i={mode:this.mode,seckill_id:this.seckillId};return"exchange"===this.mode&&(i.package_sku_ids=this.getStorage("exchange_package_sku_ids")||[]),this.$http("/shop/products/".concat(this.uuid),"POST",i).then((function(i){t.hideLoading(),e.loading=!1,e.product=i.data.info||{}}))},showPresellTips:function(){t.showModal({title:"商品预售中",content:"此商品将在开售后开放购买"})}},onPageScroll:function(e){e.scrollTop>350&&!this.isShowTitle&&(t.setNavigationBarTitle({title:this.product.title}),this.isShowTitle=!0),e.scrollTop<350&&this.isShowTitle&&(t.setNavigationBarTitle({title:"商品详情"}),this.isShowTitle=!1)}};e.default=d}).call(this,i("543d")["default"])},"0f1d":function(t,e,i){"use strict";i.r(e);var n=i("c5c1"),r=i("561b");for(var o in r)"default"!==o&&function(t){i.d(e,t,(function(){return r[t]}))}(o);i("5645");var u,s=i("f0c5"),c=Object(s["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],u);e["default"]=c.exports},"2d3d":function(t,e,i){"use strict";(function(t){i("e335");n(i("66fd"));var e=n(i("0f1d"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=i,t(e.default)}).call(this,i("543d")["createPage"])},"561b":function(t,e,i){"use strict";i.r(e);var n=i("0287"),r=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=r.a},5645:function(t,e,i){"use strict";var n=i("73d3"),r=i.n(n);r.a},"73d3":function(t,e,i){},c5c1:function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var n={PriceDisplay:function(){return i.e("components/PriceDisplay/PriceDisplay").then(i.bind(null,"5f805"))},CountDown:function(){return i.e("components/CountDown/CountDown").then(i.bind(null,"815b"))},PageRender:function(){return Promise.all([i.e("common/vendor"),i.e("components/PageRender/PageRender")]).then(i.bind(null,"250e"))},SharePopup:function(){return Promise.all([i.e("common/vendor"),i.e("components/SharePopup/SharePopup")]).then(i.bind(null,"825e"))},GroupPriceCheck:function(){return i.e("components/GroupPriceCheck/GroupPriceCheck").then(i.bind(null,"739e"))},SeckillPriceCheck:function(){return i.e("components/SeckillPriceCheck/SeckillPriceCheck").then(i.bind(null,"02b0"))},OrderReward:function(){return i.e("components/OrderReward/OrderReward").then(i.bind(null,"73a8"))}},r=function(){var t=this,e=t.$createElement,i=(t._self._c,!t.loading&&t.product.is_presell&&0===t.product.presell_mode?t.$tool.formatDate(t.product.presell_date,"MM-dd hh:mm"):null),n=!t.loading&&t.product.is_presell&&0!==t.product.presell_mode&&1===t.product.presell_mode?t.$tool.formatDate(t.product.presell_date,"yyyy-MM-dd"):null,r=!t.loading&&t.skusVisible?t._f("productAttrsToString")(t.currentSku.attrs):null;t._isMounted||(t.e0=function(e){t.isSharePopup=!0},t.e1=function(e){t.isSharePopup=!1},t.e2=function(e){t.isShowUserGroupCheck=!1},t.e3=function(e){t.isShowSeckillPriceCheck=!1},t.e4=function(e){t.isShowOrderReward=!1}),t.$mp.data=Object.assign({},{$root:{g0:i,g1:n,f0:r}})},o=[]}},[["2d3d","common/runtime","common/vendor"]]]);