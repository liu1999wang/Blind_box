(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/fudai/detail"],{"2a67":function(t,e,n){"use strict";(function(t){n("e335");i(n("66fd"));var e=i(n("a335"));function i(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},"46cb":function(t,e,n){"use strict";var i=n("94ba"),o=n.n(i);o.a},"78a4":function(t,e,n){"use strict";n.r(e);var i=n("8557"),o=n.n(i);for(var u in i)"default"!==u&&function(t){n.d(e,t,(function(){return i[t]}))}(u);e["default"]=o.a},8557:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n("26cb");function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r=function(){Promise.all([n.e("common/vendor"),n.e("pages/fudai/components/PayCard")]).then(function(){return resolve(n("e260"))}.bind(null,n)).catch(n.oe)},a=function(){n.e("pages/fudai/components/RecordList").then(function(){return resolve(n("88d4"))}.bind(null,n)).catch(n.oe)},c={components:{PayCard:r,RecordList:a},data:function(){return{uuid:"",isInit:!1,isPayPopup:!1,payTotal:0,info:{},order:{},pageUuid:"",isNotFound:!1,isShowResultPopup:!1,danmuSetting:{},danmuList:[],config:{},detailImageList:[],levelFilter:0,isTryMode:!1,isShowRankList:!1,wining_list:[],is_doubleBoxCard:0,color_list:[{level:0,color:"#00aa00"},{level:1,color:"#aa55ff"},{level:2,color:"#ffff00"},{level:3,color:"#ffff00"},{level:4,color:"#ff0000"}]}},computed:u(u({},(0,i.mapGetters)(["userInfo"])),{},{bgImage:function(){return"https://cdn2.hquesoft.com/box/fudai/detail_bg.png"},boxImage:function(){return this.info.image_3d||"https://cdn2.hquesoft.com/box/fudai/box.png"},skuLevel:function(){return this.info.sku_level||[]},skus:function(){var t=this;return this.levelFilter?this.info.skus.filter((function(e){return e.level===t.levelFilter})):this.info.skus||[]},payInfo:function(){return{page_uuid:this.pageUuid,title:this.info.title,pay_total:this.payTotal,total_list:this.info.total_list,money_price:this.info.money_price,score_price:this.info.score_price}},titleBgColor:function(){return" "},titleColor:function(){return"#ffffff"},setTitleText:function(){t.setNavigationBarTitle({title:this.info.title})},discountTips:function(){for(var t=this.info.total_list||[],e=t.length-1;e>=0;e--)if(t[e].is_discount){var n=t[e].total+"连开优惠";return t[e].money_discount&&(n+=t[e].money_discount/100+"元"),t[e].score_discount&&(n+=t[e].score_discount+this.scoreAlias),n}return!1},width_value:function(){return this.userInfo.lucky_score/this.info.min_lucky_score*100>100?100:this.userInfo.lucky_score/this.info.min_lucky_score*100<0?0:Math.trunc(this.userInfo.lucky_score/this.info.min_lucky_score*100)}}),watch:{},filters:{},onLoad:function(t){this.uuid=t.uuid},onUnload:function(){},onPullDownRefresh:function(){this.$showPullRefresh(),this.initData(),this.setTitleText()},onShow:function(){var e=this;t.showLoading({title:"加载中"}),this.initData().then((function(n){e.isInit=!0,t.hideLoading(),e.$http("/fudai/change","POST",{fudai_id:e.info.id}).then((function(t){e.pageUuid=t.data.page_uuid,e.fetchList()}))})).catch((function(t){e.isNotFound=!0}))},onReachBottom:function(){},methods:{handleTry:function(){var e=this;t.showModal({title:"试玩提示",content:"试玩开出的奖品仅作为演示作用，不可作发货及其它作用",confirmText:"同意试玩",cancelText:"取消",success:function(n){n.confirm&&(t.showLoading({title:"操作中~"}),t.navigateTo({url:"/pages/try/detail?uuid=".concat(e.info.uuid)}))}})},fetchList:function(){var t=this;return!this.isLoading&&(this.isLoading=!0,this.$http("/fudais/".concat(this.info.uuid,"/records"),"GET",{page:1,per_page:100}).then((function(e){t.isInit=!0;for(var n=0;n<e.data.list.length;n++)t.wining_list.length<12&&5==e.data.list[n].level&&t.wining_list.push(e.data.list[n])})).catch((function(e){t.isInit=!1})))},setLevelFilter:function(t){this.levelFilter===t?this.levelFilter=0:this.levelFilter=t},gomybox:function(){t.reLaunch({url:"/pages/myBox/index"})},useFreeTicket:function(){var e=this;t.showLoading({title:"提交中",icon:"none"}),this.$http("/fudai/order/confirm","POST",{page_uuid:this.pageUuid,total:1,is_use_free_ticket:1}).then((function(n){t.hideLoading();var i=n.data;i.is_need_pay?t.showToast({title:"兑换出错~",icon:"none"}):e.paySuccess(i.order)}))},getDanmu:function(){var t=this;this.$http("/danmus/fudai_detail?node_id=".concat(this.info.id)).then((function(e){t.danmuSetting=e.data.setting,t.danmuList=e.data.list}))},showDetailImagePopup:function(e){return e.product_id?(t.navigateTo({url:"/pages/productDetail/index?mode=view&uuid="+e.product_id}),!1):e.detail_images&&e.detail_images.length?(this.$refs.detailPopup.open("bottom"),void(this.detailImageList=e.detail_images||[])):(t.showToast({title:"此款暂无详情~",icon:"none"}),!1)},hideDetailImagePopup:function(){this.$refs.detailPopup.close()},refresh:function(){this.$store.dispatch("getUserInfo")},initData:function(){var e=this;return this.$http("/fudais/".concat(this.uuid),"GET",{}).then((function(n){e.info=n.data.info,e.config=n.data.config,e.info.sku_level=e.info.sku_level.sort().reverse(),console.log(e.info.sku_level),console.log(e.info.skus),e.getDanmu(),t.setNavigationBarTitle({title:e.info.title})}))},paySuccess:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;this.isTryMode=e,this.order=t,this.is_doubleBoxCard=n,this.isPayPopup=!1,this.isShowResultPopup=!0,this.refresh()},goBack:function(){this.isShowResultPopup=!1},hidePayPopup:function(){this.isPayPopup=!1},pay:function(t){this.payTotal=t,this.isPayPopup=!0},getLevelIcon:function(t){return this.skuLevel.find((function(e){return e.level===t})).icon},getLevelTitle:function(t){return this.skuLevel.find((function(e){return e.level===t})).title}},onPageScroll:function(t){}};e.default=c}).call(this,n("543d")["default"])},"94ba":function(t,e,n){},a335:function(t,e,n){"use strict";n.r(e);var i=n("bb66"),o=n("78a4");for(var u in o)"default"!==u&&function(t){n.d(e,t,(function(){return o[t]}))}(u);n("46cb");var s,r=n("f0c5"),a=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"d057e734",null,!1,i["a"],s);e["default"]=a.exports},bb66:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return i}));var i={PriceDisplay:function(){return n.e("components/PriceDisplay/PriceDisplay").then(n.bind(null,"5f805"))},uniPopup:function(){return n.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(n.bind(null,"c81d"))},BoxSkuPopup:function(){return n.e("components/BoxSkuPopup/BoxSkuPopup").then(n.bind(null,"430f"))},OpenBoxPopupTheme2:function(){return n.e("components/OpenBoxPopupTheme2/OpenBoxPopupTheme2").then(n.bind(null,"5274"))},FreeTicketFloatBtn:function(){return n.e("components/FreeTicketFloatBtn/FreeTicketFloatBtn").then(n.bind(null,"43e1"))},Danmus:function(){return n.e("components/Danmus/Danmus").then(n.bind(null,"633b"))}},o=function(){var t=this,e=t.$createElement,n=(t._self._c,t.__map(t.wining_list,(function(e,n){var i=t.__get_orig(e),o=e.user.name.slice(0,2),u=e.created_at.slice(5,10);return{$orig:i,g0:o,g1:u}}))),i=t.__map(t.info.sku_level,(function(e,n){var i=t.__get_orig(e),o=e.odds.toFixed(2),u=t.__map(t.skus,(function(n,i){var o=t.__get_orig(n),u=e.level==n.level?t.getLevelIcon(n.level):null;return{$orig:o,m0:u}}));return{$orig:i,g2:o,l1:u}}));t._isMounted||(t.e0=function(e){t.isShowRankList=!0},t.e1=function(e){t.isShowRankList=!1}),t.$mp.data=Object.assign({},{$root:{l0:n,l2:i}})},u=[]}},[["2a67","common/runtime","common/vendor"]]]);